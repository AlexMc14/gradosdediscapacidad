---
import SEOHead from '@components/seo/SEOHead.astro';
import SchemaOrg from '@components/seo/SchemaOrg.astro';
import { generateOrganizationSchema } from '@lib/schema-generators';
import '@assets/styles/global.css';

interface Props {
  title: string;
  description: string;
  canonical?: string;
  ogImage?: string;
  ogType?: 'website' | 'article';
  noindex?: boolean;
  schema?: Record<string, any> | Record<string, any>[];
  article?: {
    publishedTime?: string;
    modifiedTime?: string;
    author?: string;
    tags?: string[];
  };
}

const {
  title,
  description,
  canonical,
  ogImage,
  ogType = 'website',
  noindex = false,
  schema,
  article,
} = Astro.props;

// Schema por defecto (Organization) siempre presente
const organizationSchema = generateOrganizationSchema();
const schemas = schema
  ? Array.isArray(schema)
    ? [organizationSchema, ...schema]
    : [organizationSchema, schema]
  : [organizationSchema];
---

<!doctype html>
<html lang="es">
  <head>
    <SEOHead
      title={title}
      description={description}
      canonical={canonical}
      ogImage={ogImage}
      ogType={ogType}
      noindex={noindex}
      article={article}
    />

    <SchemaOrg schema={schemas} />

    <!-- Google Analytics (opcional - agregar cuando estÃ© configurado) -->
    <!-- {import.meta.env.PUBLIC_GA_MEASUREMENT_ID && (
      <script type="text/partytown" async src={`https://www.googletagmanager.com/gtag/js?id=${import.meta.env.PUBLIC_GA_MEASUREMENT_ID}`}></script>
      <script type="text/partytown">
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', import.meta.env.PUBLIC_GA_MEASUREMENT_ID);
      </script>
    )} -->
  </head>
  <body>
    <slot />
  </body>
</html>
